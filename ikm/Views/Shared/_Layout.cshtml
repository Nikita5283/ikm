<!DOCTYPE html>
<html lang="ru" data-bs-theme="light" id="htmlPage">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Tracker</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
</head>
<body>

    <div class="container-fluid">
        <div class="row">

            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-body-tertiary sidebar collapse collapse-horizontal">
                <div class="position-sticky pt-3">

                    <a asp-controller="Home" asp-action="Index" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none px-3">
                        <i class="fa-solid fa-chart-pie fa-2x me-2 text-primary"></i>
                        <span class="fs-4 fw-bold">Tracker</span>
                    </a>
                    <hr>

                    <ul class="nav flex-column nav-pills px-2">

                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "Apps" ? "active" : "")"
                               asp-controller="Apps" asp-action="Index">
                                <i class="fa-brands fa-windows me-2"></i> Приложения
                            </a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "Sites" ? "active" : "")"
                               asp-controller="Sites" asp-action="Index">
                                <i class="fa-solid fa-globe me-2"></i> Сайты
                            </a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "Videos" ? "active" : "")"
                               asp-controller="Videos" asp-action="Index">
                                <i class="fa-brands fa-youtube me-2"></i> Видео
                            </a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "AppSessions" ? "active" : "")"
                               asp-controller="AppSessions" asp-action="Index">
                                <i class="fa-solid fa-window-restore me-2"></i> Посещения приложений
                            </a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "PageSessions" ? "active" : "")"
                               asp-controller="PageSessions" asp-action="Index">
                                <i class="fa-solid fa-clock-rotate-left me-2"></i> Посещения страниц
                            </a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "ViewSessions" ? "active" : "")"
                               asp-controller="ViewSessions" asp-action="Index">
                                <i class="fa-solid fa-eye me-2"></i> Просмотры видео
                            </a>
                        </li>

                    </ul>

                    <hr>

                    <div class="px-3">
                        <button class="btn btn-outline-secondary w-100 btn-sm" id="themeSwitcher">
                            <i class="fa-solid fa-moon"></i> Темная тема
                        </button>
                    </div>
                </div>
            </nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 py-4">
                @RenderBody()
            </main>
        </div>
    </div>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script src="~/js/site.js" asp-append-version="true"></script>

    <script>
        const htmlElement = document.getElementById('htmlPage');
        const themeSwitcher = document.getElementById('themeSwitcher');
        const icon = themeSwitcher.querySelector('i');

        // 1. Загрузка сохраненной темы
        const savedTheme = localStorage.getItem('theme') || 'light';
        setTheme(savedTheme);

        // 2. Клик по кнопке
        themeSwitcher.addEventListener('click', () => {
            const currentTheme = htmlElement.getAttribute('data-bs-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            setTheme(newTheme);
        });

        function setTheme(theme) {
            htmlElement.setAttribute('data-bs-theme', theme);
            localStorage.setItem('theme', theme);

            if (theme === 'dark') {
                themeSwitcher.innerHTML = '<i class="fa-solid fa-sun"></i> Светлая тема';
                themeSwitcher.classList.replace('btn-outline-secondary', 'btn-outline-light');
            } else {
                themeSwitcher.innerHTML = '<i class="fa-solid fa-moon"></i> Темная тема';
                themeSwitcher.classList.replace('btn-outline-light', 'btn-outline-secondary');
            }
        }
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>